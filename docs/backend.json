{
  "entities": {
    "Booking": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Booking",
      "type": "object",
      "description": "Represents a taxi booking request.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the booking entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the person making the booking."
        },
        "contact": {
          "type": "string",
          "description": "Contact information of the person making the booking."
        },
        "pickupPoint": {
          "type": "string",
          "description": "Pickup location for the booking."
        },
        "dropOffPoint": {
          "type": "string",
          "description": "Drop-off location for the booking."
        },
        "dateTime": {
          "type": "string",
          "description": "Date and time of the booking.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "The status of the booking (e.g., pending, confirmed, completed, cancelled)."
        },
        "customerId": {
          "type": "string",
          "description": "The UID of the customer who made the booking."
        }
      },
      "required": [
        "name",
        "contact",
        "pickupPoint",
        "dropOffPoint",
        "dateTime",
        "status",
        "customerId"
      ]
    },
    "ContactFormSubmission": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ContactFormSubmission",
      "type": "object",
      "description": "Represents a contact form submission.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the contact form submission entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the person submitting the contact form."
        },
        "email": {
          "type": "string",
          "description": "Email address of the person submitting the contact form.",
          "format": "email"
        },
        "message": {
          "type": "string",
          "description": "Message content from the contact form."
        },
        "submissionDate": {
          "type": "string",
          "description": "Date and time of the contact form submission.",
          "format": "date-time"
        }
      },
      "required": ["name", "email", "message", "submissionDate"]
    },
    "UserProfile": {
      "title": "User Profile",
      "description": "Represents a user's public profile information.",
      "type": "object",
      "properties": {
        "displayName": {
          "type": "string"
        },
        "photoURL": {
          "type": "string",
          "format": "uri"
        }
      },
      "required": ["displayName"]
    },
    "AdminUser": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AdminUser",
      "type": "object",
      "description": "Represents an admin user who can manage the system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the admin user."
        },
        "username": {
          "type": "string",
          "description": "Username of the admin user."
        },
        "email": {
          "type": "string",
          "description": "Email address of the admin user.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "Role of the admin user (e.g., superadmin, editor)."
        }
      },
      "required": ["id", "username", "email", "role"]
    },
    "Customer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Customer",
      "type": "object",
      "description": "Represents a customer of the taxi service.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the customer (matches Firebase Auth UID)."
        },
        "firstName": {
          "type": "string",
          "description": "First name of the customer."
        },
        "lastName": {
          "type": "string",
          "description": "Last name of the customer."
        },
        "email": {
          "type": "string",
          "description": "Email address of the customer.",
          "format": "email"
        },
        "phone": {
          "type": "string",
          "description": "Phone number of the customer."
        },
        "address": {
          "type": "string",
          "description": "Address of the customer."
        }
      },
      "required": ["id", "firstName", "lastName", "email", "phone"]
    }
  },
  "auth": {
    "providers": ["password", "anonymous"]
  },
  "firestore": {
    "structure": [
      {
        "path": "/roles_admin/{userId}",
        "definition": {
          "entityName": "AdminUser",
          "schema": {
            "$ref": "#/backend/entities/AdminUser"
          },
          "description": "Collection to store admin users. Existence of a document signifies admin role. This collection is read-only from the client.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Auth UID of the admin user."
            }
          ]
        }
      },
      {
        "path": "/bookings/{bookingId}",
        "definition": {
          "entityName": "Booking",
          "schema": {
            "$ref": "#/backend/entities/Booking"
          },
          "description": "Collection to store all booking requests. Read access is restricted to admins and the customer who created the booking.",
          "params": [
            {
              "name": "bookingId",
              "description": "The unique identifier for the booking."
            }
          ]
        }
      },
      {
        "path": "/contact_form_submissions/{submissionId}",
        "definition": {
          "entityName": "ContactFormSubmission",
          "schema": {
            "$ref": "#/backend/entities/ContactFormSubmission"
          },
          "description": "Collection to store contact form submissions. Read access is restricted to admins.",
          "params": [
            {
              "name": "submissionId",
              "description": "The unique identifier for the contact form submission."
            }
          ]
        }
      },
      {
        "path": "/customers/{customerId}",
        "definition": {
          "entityName": "Customer",
          "schema": {
            "$ref": "#/backend/entities/Customer"
          },
          "description": "Collection to store customer data. The document ID must match the Firebase Auth UID of the user.",
          "params": [
            {
              "name": "customerId",
              "description": "The unique identifier for the customer, matching their Firebase Auth UID."
            }
          ]
        }
      }
    ],
    "reasoning": "This Firestore structure prioritizes security, scalability, and debuggability. Admins are managed via a `/roles_admin` collection. Bookings are stored centrally in `/bookings` with a `customerId` field to link them to the user who created them, which avoids costly lookups in security rules. The `/customers` collection stores user details and uses path-based ownership (the document ID is the user's UID), ensuring users can only access their own data. Contact submissions are publicly writable but only readable by admins. This design enforces clear ownership and access patterns."
  }
}
